#summary HTML исходники всех игровых страниц с картинками

= Introduction =

Для исторических целей перед вводом Редизайна была проведена обширная работа по сохранению HTML-кода всех оригинальных страниц. Результаты этой работы будут использованы для воссоздания оригинального облика игры.

Разметка всех игровых страниц однотипна и состоит из следующих частей:
 * Заголовок (header): мета-теги, теги head/title, подгрузка стилей и общих скриптов. Начало тега body.
 * Панель списка планет, ресурсов и офицеров (на некоторых страницах может отсутствовать)
 * "Левое меню": называется так, потому что находится в левой части экрана (на некоторых страницах может отсутствовать)
 * Содержимое (content): тут находятся непосредственно элементы игровой страницы
 * Хвост (footer): закрывается тег body/html и прочая мелочь.

В HTML коде *{вот так}* будут показываться места, где PHP-код генерирует контент, например путь к скину или какие-нибудь параметры.

= Заголовок =

{{{
 
<html> 
 <head> 
  <link rel='stylesheet' type='text/css' href='css/default.css' /> 
  <link rel='stylesheet' type='text/css' href='css/formate.css' /> 
 
  <script language="JavaScript">var session="1f855da316dd";</script> 
  <meta http-equiv="content-type" content="text/html; charset=koi8-r" /> 
 
<link rel="stylesheet" type="text/css" href="css/combox.css"> 
<link rel="stylesheet" type="text/css" href="{USER_SKIN_PATH}formate.css" /> 
 
<title>Вселенная 15 ОГейм</title> 
 
  <script src="js/utilities.js" type="text/javascript"></script> 
  <script language="JavaScript"> 
  </script> 
<script type="text/javascript" src="js/overLib/overlib.js"></script> 
<!-- HEADER --> 
 
<script language="JavaScript"> 
function onBodyLoad() {
    window.setTimeout("reloadImages()", 100);
}
 
function reloadImages() {
    for (var i = 0; i < document.images.length; ++i) {
      if ((document.images[i].className == 'reloadimage') && (document.images[i].title != "")) {
        document.images[i].src = document.images[i].title;
      }
    }
}
</script> 
 
</head> 
<body style="overflow: hidden;" onload="onBodyLoad();" onunload="" > 
<div id="overDiv" style="position:absolute; visibility:hidden; z-index:1000;"></div> 
}}}

Краткое описание компонентов заголовка:
 * Подгружаются дефолтные стили `css/default.css` и `css/formate.css`, которые затем перегружаются стилем установленного скина `{USER_SKIN_PATH}formate.css`. Небольшая особенность: в пути к скину в конце всегда должна стоять `/` иначе format.css слепится с путём к скину и итоговый путь будет неверным. Путь к скину берется из настроек пользователя:<br><img src="http://ogamespec.com/imgstore/whc4d651e5551511.jpg">
 * Установка кодировки через META-тег. Как видно тут ещё используется кодировка koi8-r, потому что сохранение страниц началось до повсевместного ввода кодировки utf-8 в игру.
 * Подгружается скрипт оверлеев `overlib.js`. Оверлеи - это всплывающие окна, которые выплывают к примеру в Галактике при наведении мышки на картинку планеты:<br><img src="http://ogamespec.com/imgstore/whc4d651ccc14f0a.jpg"><br>Скрипт `overlib.js` кстати OpenSource.
 * устанавливается таймер на вызов функции `reloadImages()` каждые 100ms. Эта функция принудительно перегружает все картинки `img`, у которых `class=reloadimage`. Я таких в игре не встречал.
 * Подгружается скрипт `js/utilities.js` 
 * Устанавливается заголовок страницы, например *`Вселенная 15 ОГейм`*
 * Создается div `id=overDiv`, который представляет собой контейнер для оверлея.

= Хвост =

{{{
<script> 
messageboxHeight=0;
errorboxHeight=0;
contentbox = document.getElementById('content');
</script> 
 
<div id='messagebox'> 
<center> 
{MESSAGE_TEXT}</center> 
</div> 
<div id='errorbox'> 
<center> 
{ERROR_TEXT}</center> 
</div> 
 
<script> 
headerHeight = 81;
errorbox.style.top=parseInt(headerHeight+messagebox.offsetHeight+5)+'px';
contentbox.style.top=parseInt(headerHeight+errorbox.offsetHeight+messagebox.offsetHeight+10)+'px';
if (navigator.appName=='Netscape'){if (window.innerWidth<1020){document.body.scroll='no';}   contentbox.style.height=parseInt(window.innerHeight)-messagebox.offsetHeight-errorbox.offsetHeight-headerHeight-20;
if(document.getElementById('resources')) {   document.getElementById('resources').style.width=(window.innerWidth*0.4);}}
 else {
if (document.body.offsetWidth<1020){document.body.scroll='no';}   contentbox.style.height=parseInt(document.body.offsetHeight)-messagebox.offsetHeight-headerHeight-errorbox.offsetHeight-20;document.getElementById('resources').style.width=(document.body.offsetWidth*0.4);
}for (var i = 0; i < document.links.length; ++i) {
  if (document.links[i].href.search(/.*redir\.php\?url=.*/) != -1) {
    document.links[i].target = "_blank";
  }
}
 
</script> 
<style> 
.layer {
    z-index:999999999;
    position:absolute;
    left: 0;
    right: 0;
    top: 100px;
    margin-left: auto;
    margin-right: auto;
    width: 757px; 
    height: 475px; 
    background-color: #040e1e;
    border: 3px double orange;
    padding: 0;
    opacity: .90;
}
</style> 
 </body> 
</html>
}}}

В хвосте находятся следующие элементы:
 * Контейнеры для сообщения и ошибки. Сообщение - это небольшой текст наверху страницы, заключенный в зеленую рамочку, например:<br><img src="http://ogamespec.com/imgstore/whc4d6523a207802.jpg"><br>Ошибка - аналогично, но цвет рамки красный:<br><img src="http://ogamespec.com/imgstore/whc4d6524bb241af.jpg">
 * Небеольшой скрипт, для расчёта Y-координат контента, при наличии сообщения и/или ошибки.
 * Какой-то непонятный стиль `layer`, где используется неясно. Возможно просто артефакт от старых версий.

Для всплывающих окон наподобии `Заметок` хвост имеет немного другой вид:

{{{
...
headerHeight = 81;
...
}}}

заменяется на :

{{{
...
messagebox.style.top='0px';
headerHeight = 0;
contentbox.style.left='0px';
contentbox.style.width='100%';
...
}}}

чтобы сдвинуть контент страницы в левый верхний угол.

В меню `Галактика` :

{{{
...
headerHeight = 81;
...
}}}

заменяется на :

{{{
...
messagebox.style.top='0px';
headerHeight = 0;
...
}}}

Так как в Галактике нет панели ресурсов.

Также если {MESSAGE_TEXT} или {ERROR_TEXT} не пустые, добавляется две инструкции для создания видимости этих контейнеров:

{{{
...
headerHeight = 81;
messagebox.style.display='block';
errorbox.style.display='block';
...
}}}

Контейнер сообщений и ошибки могут одновременно находиться на странице.

= Панель ресурсов =

<img src="http://ogamespec.com/imgstore/oldogame_respane.jpg">

= Левое меню =

<img src="http://ogamespec.com/imgstore/oldogame_leftmenu.jpg">

= Содержимое игровых страниц =

==Обзор==
==Постройки ==
==Сырьё ==
==Исследования==
==Верфь==
==Флот ==
==Технологии ==
==Галактика ==
==Оборона ==
==Мой альянс==
==Статистика ==
==Поиск ==
==Сообщения==
==Заметки==
==Друзья ==
==Настройки ==

==Выход ==

Страничка выхода их игры отличается от стандартной схемы, ниже приведен полный HTML этой странички:
{{{
<html>
 <head>
 <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
 <link rel="stylesheet" type="text/css" href="{USER_SKIN_PATH}formate.css" />
  <meta http-equiv="refresh" content="3;URL=http://ogame.ru?redirect=1" />
  <title>Logout</title>

 <script language="JavaScript">
 function popUp(URL) {
   day = new Date();
   id = day.getTime();
   eval("page" + id + " = window.open(URL, '" + id + "', 'toolbar=1,scrollbars=1,location=1,statusbar=1,menubar=0,resizable=1,width=800,height=600');");
}
 </script>
</head>

<body class='style' topmargin='0' leftmargin='0' marginwidth='0' marginheight='0' >
<div id="overDiv" style="position:absolute; visibility:hidden; z-index:1000;"></div>
<center>
До скорого!!<br />
<p>
             </p>
</center>
</body>
</html>
}}}