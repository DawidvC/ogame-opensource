#summary Особенности работы очереди построек

= Обзор =

В игре есть глобальная очередь событий (queue), в которой хранится текущая постройка/снос на планете.
Тип события - Build, для постройки, Demolish - для сноса.

Когда у пользователя активен Командир, то у него появляется возможность "складывать" новые постройки в дополнительную специальную очередь - очередь построек (build queue или по немецки bauliste).

= Детали =

Формат таблицы очереди построек *bqueue*:

|| *столбец* || *SQL тип* || *описание* ||
|| id|| INT AUTO_INCREMENT PRIMARY KEY|| Порядковый номер, начинается с 1||
|| ownwer_id || INT  || ID пользователя ||
|| planet_id || INT  || ID планеты ||
|| list_id || INT || порядковый номер внутри очереди ||
|| tech_id || INT || ID постройки ||
|| level || INT || целевой уровень ||
|| destroy || INT || 1 - снести, 0 - построить ||

У каждой планеты своя очередь построек. Постройки строятся по порядку, в зависимости от list_id.

= Строительство построек в обычном режиме =

URL для постройки: http://uni20.ogame.de/game/index.php?page=b_building&session=cbfc8ad862b5&modus=add&techid=1&planet=1281073
URL для сноса: http://uni20.ogame.de/game/index.php?page=b_building&session=cbfc8ad862b5&techid=1&modus=destroy&planet=1281073

techid : ID постройки<br>
planet : ID планеты

== Постройка ==

  * Проверяется возможность строительства постройки
  * Списываются ресурсы, равные стоимости постройки
  * В глобальную очередь queue помещается задание типа Build, start = текущему моменту времени, end = start + длительность постройки

== Снос ==

  * То же самое что и постройка, только тип задания Demolish

== Отмена ==

  * Возвращаются ресурсы
  * Из очереди queue удаляется событие

== Завершение постройки/сноса ==

  * Корректируется уровень постройки
  * Корректируется количество полей на планете
  * Пересчитывается статистика
  * Из очереди queue удаляется событие

= Строительство построек с очередью =

== Добавление первой постройки ==

== Добавление последующей (складывание в очередь) ==

== Отмена текущей постройки ==

== Отмена последующей ==

== Завершение текущей постройки ==